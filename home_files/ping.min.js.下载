(()=>{"use strict";var t={228:t=>{var n=Object.prototype.hasOwnProperty,e="~";function r(){}function o(t,n,e){this.fn=t,this.context=n,this.once=e||!1}function i(t,n,r,i,c){if("function"!=typeof r)throw new TypeError("The listener must be a function");var u=new o(r,i||t,c),a=e?e+n:n;return t._events[a]?t._events[a].fn?t._events[a]=[t._events[a],u]:t._events[a].push(u):(t._events[a]=u,t._eventsCount++),t}function c(t,n){0==--t._eventsCount?t._events=new r:delete t._events[n]}function u(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(e=!1)),u.prototype.eventNames=function(){var t,r,o=[];if(0===this._eventsCount)return o;for(r in t=this._events)n.call(t,r)&&o.push(e?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(t)):o},u.prototype.listeners=function(t){var n=e?e+t:t,r=this._events[n];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,i=r.length,c=new Array(i);o<i;o++)c[o]=r[o].fn;return c},u.prototype.listenerCount=function(t){var n=e?e+t:t,r=this._events[n];return r?r.fn?1:r.length:0},u.prototype.emit=function(t,n,r,o,i,c){var u=e?e+t:t;if(!this._events[u])return!1;var a,s,f=this._events[u],p=arguments.length;if(f.fn){switch(f.once&&this.removeListener(t,f.fn,void 0,!0),p){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,n),!0;case 3:return f.fn.call(f.context,n,r),!0;case 4:return f.fn.call(f.context,n,r,o),!0;case 5:return f.fn.call(f.context,n,r,o,i),!0;case 6:return f.fn.call(f.context,n,r,o,i,c),!0}for(s=1,a=new Array(p-1);s<p;s++)a[s-1]=arguments[s];f.fn.apply(f.context,a)}else{var l,d=f.length;for(s=0;s<d;s++)switch(f[s].once&&this.removeListener(t,f[s].fn,void 0,!0),p){case 1:f[s].fn.call(f[s].context);break;case 2:f[s].fn.call(f[s].context,n);break;case 3:f[s].fn.call(f[s].context,n,r);break;case 4:f[s].fn.call(f[s].context,n,r,o);break;default:if(!a)for(l=1,a=new Array(p-1);l<p;l++)a[l-1]=arguments[l];f[s].fn.apply(f[s].context,a)}}return!0},u.prototype.on=function(t,n,e){return i(this,t,n,e,!1)},u.prototype.once=function(t,n,e){return i(this,t,n,e,!0)},u.prototype.removeListener=function(t,n,r,o){var i=e?e+t:t;if(!this._events[i])return this;if(!n)return c(this,i),this;var u=this._events[i];if(u.fn)u.fn!==n||o&&!u.once||r&&u.context!==r||c(this,i);else{for(var a=0,s=[],f=u.length;a<f;a++)(u[a].fn!==n||o&&!u[a].once||r&&u[a].context!==r)&&s.push(u[a]);s.length?this._events[i]=1===s.length?s[0]:s:c(this,i)}return this},u.prototype.removeAllListeners=function(t){var n;return t?(n=e?e+t:t,this._events[n]&&c(this,n)):(this._events=new r,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=e,u.EventEmitter=u,t.exports=u}},n={};function e(r){var o=n[r];if(void 0!==o)return o.exports;var i=n[r]={exports:{}};return t[r](i,i.exports,e),i.exports}(()=>{const t=e(228),n={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let r;const o=new Uint8Array(16);function i(){if(!r&&(r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!r))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(o)}const c=[];for(let t=0;t<256;++t)c.push((t+256).toString(16).slice(1));function u(t,n=0){return c[t[n+0]]+c[t[n+1]]+c[t[n+2]]+c[t[n+3]]+"-"+c[t[n+4]]+c[t[n+5]]+"-"+c[t[n+6]]+c[t[n+7]]+"-"+c[t[n+8]]+c[t[n+9]]+"-"+c[t[n+10]]+c[t[n+11]]+c[t[n+12]]+c[t[n+13]]+c[t[n+14]]+c[t[n+15]]}const a=function(t,e,r){if(n.randomUUID&&!e&&!t)return n.randomUUID();const o=(t=t||{}).random||(t.rng||i)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,e){r=r||0;for(let t=0;t<16;++t)e[r+t]=o[t];return e}return u(o)};function s(){return t=(new Date).getTime(),parseFloat(t.toString().replace(/(\d{3})$/,".$1"));var t}function f(){return a().replace(/-/g,"")}var p;function l(){return void 0!==window.pdst?p.VersionA:p.VersionB}function d(){return void 0!==window.spotifyPixelV2}!function(t){t.VersionA="a",t.VersionB="b"}(p||(p={}));var v=function(){if(d()){return"".concat("2.0.0","-").concat(l())}return"".concat("1.1.0","-").concat(l())},y={},h=!1,w=function(){y={key:null,lifetime:365,group:null,label:null,experiment:null}};function _(t){return Object.prototype.hasOwnProperty.call(y,t)?y[t]:null}w();var m=function(){function t(){this.time=s(),this.action=null,this.group=null,this.label=null,this.experiment=null}return t.prototype.update=function(t){var n=this;t&&Object.keys(this.fields).reduce((function(e,r){r in t&&(n[r]=t[r])}),{})},t.prototype.data=function(){var t=this;return{action:this.action,time:this.time,group:null!==this.group?this.group:_("group"),label:null!==this.label?this.label:_("label"),experiment:null!==this.experiment?this.experiment:_("experiment"),body:Object.keys(this.fields).reduce((function(n,e){return n[e]=t.fields[e](t[e]),n}),{})}},t}(),g=function(){return function(t){return"string"==typeof t?t:"number"==typeof t?t.toString():null}},O=function(){return function(t){var n=parseInt(t,10);return isNaN(n)?null:n}},b=function(){return function(t){var n=parseFloat(t);return isNaN(n)?null:n}},j=function(){return function(t){return["True","true","1",1,!0].indexOf(t)>-1||!(["False","false","0",0,!1].indexOf(t)>-1)&&null}},x=function(t){return function(n){var e;if(Array.isArray(n))e=n;else{if(null==n)return null;e=[n]}return t?e.map((function(n){return Object.keys(t).reduce((function(e,r){return e[r]=t[r](n[r]),e}),{})})):e}},S=function(t){return function(n){return n?t?Object.keys(t).reduce((function(e,r){return e[r]=t[r](n[r]),e}),{}):n:{}}};const P=m;var A,T=(A=function(t,n){return A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},A(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}A(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),k=function(){return k=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t},k.apply(this,arguments)};const E=function(t){function n(n){var e=t.call(this)||this;e.action=d()?"view":"init";var r=S({source:g(),placement:g(),from:g()});e.fields=k({url:g(),referrer:g(),inIframe:j(),windowWidth:O(),windowHeight:O(),timezoneOffset:O()},d()?{viewParams:r}:{params:r}),e.url=n.url?n.url:window.location.toString(),e.referrer=n.referrer?n.referrer:document.referrer,e.inIframe=function(){try{return window.self!==window.top}catch(t){return!0}}(),e.windowWidth=window.innerWidth,e.windowHeight=window.innerHeight,e.timezoneOffset=(new Date).getTimezoneOffset();var o={source:n.source?n.source:null,placement:n.placement?n.placement:null,from:n.from?n.from:null};return d()?e.params=o:e.viewParams=o,e}return T(n,t),n}(P);var C=["url","referrer"];var I=function(t,n,e){var r="";if(e){var o=new Date;o.setTime(o.getTime()+24*e*60*60*1e3),r="; expires=".concat(o.toUTCString())}document.cookie="".concat(t,"=").concat(n).concat(r,"; SameSite=Strict; path=/")},D=function(t){for(var n="".concat(t,"="),e=document.cookie.split(";"),r=0;r<e.length;r+=1){for(var o=e[r];" "===o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(n))return o.substring(n.length,o.length)}return null},U=l()===p.VersionA?"__pdst":"__spdt",L=function(){var t=D(U);return t||(t=f(),I(U,t,_("lifetime")),t=D(U)),t||"0"},q=function(){var t="0";if(window.sessionStorage){var n=sessionStorage.getItem(U);n||(sessionStorage.setItem(U,f()),n=sessionStorage.getItem(U)),t=n||"0"}return t},V={user:L(),session:q(),page:f()};const R=V;var N={},H=function(t){if(!t)return!1;var n,e="spdt-".concat(s(),"-").concat((void 0===n&&(n=1e3),Math.floor(Math.random()*n))),r={order:0,pid:R.page,sid:R.session,event:t};try{r.order=localStorage.length,localStorage.setItem(e,JSON.stringify(r))}catch(t){r.order=Object.keys(N).length,N[e]=r}return!0};var J=[],z=function(t){var n=function(){var t=Object.keys(N).map((function(t){return N[t]}));if(window.localStorage)for(var n=0;n<localStorage.length;n+=1){var e=localStorage.key(n);if(e&&/^spdt-[.\d]+-\d+/.test(e)){var r=localStorage.getItem(e);null!==r&&t.push(JSON.parse(r))}}var o=t.reduce((function(t,n){var e="".concat(n.sid,".").concat(n.pid);return e in t?t[e].push(n):t[e]=[n],t}),{});return Object.keys(o).map((function(t){return o[t].sort((function(t,n){return t.order-n.order}))})).sort((function(t,n){return t[0].order-n[0].order})).map((function(t){return{pid:t[0].pid,sid:t[0].sid,events:t.map((function(t){return t.event}))}}))}();if(function(){for(var t=window.localStorage?localStorage.length:0,n=[],e=0;e<=t;e+=1){var r=localStorage.key(e);r&&/^spdt-[.\d]+-\d+/.test(r)&&n.push(r)}n.forEach((function(t){localStorage.removeItem(t)})),N={}}(),0===n.length)return!1;var e=R.page;n.forEach((function(t){t.pid===e&&(J=J.concat(t.events))}));var r=n.map((function(t){var n=d()?{pixel_id:_("key")}:{key:_("key")};return Object.assign(t,{uid:R.user,time:s(),pixel_version:v()},n)}));return t.emit("api.capture",r),!0};function F(t){t.addListener("api.capture",(function(n){(function(t){var n="https://evnt.byspotify.com";l()===p.VersionA&&(n="https://us-central1-adaptive-growth.cloudfunctions.net/pdst-events-prod-sink"),d()&&(n="https://pixels.spotify.com/v1/ingest");var e={batch:t};return fetch(n,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:d()?JSON.stringify(e):JSON.stringify(t)}).catch((function(){}))})(n).then((function(){t.emit("api.captured")}))}))}var W=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}();const B=function(t){function n(n){var e=t.call(this)||this;return e.action="alias",d()?(n.alias_id=n.id,n.user_hashed_email=n.email,e.fields={alias_id:g(),user_hashed_email:g()}):e.fields={id:g(),email:g()},e.update(n),e}return W(n,t),n}(P);var M=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}();const $=function(t){function n(n){var e=t.call(this)||this;return e.action="product",e.fields={value:b(),currency:g(),product_id:g(),product_name:g(),product_type:g(),product_vendor:g()},e.update(n),e}return M(n,t),n}(P);var G=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}();const K=function(t){function n(n){var e=t.call(this)||this;return e.action="addtocart",e.fields={value:b(),quantity:O(),currency:g(),product_id:g(),product_name:g(),product_type:g(),product_vendor:g(),variant_id:g(),variant_name:g()},e.update(n),e}return G(n,t),n}(P);var Q=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}();const X=function(t){function n(n){var e=t.call(this)||this;return e.action="purchase",e.fields={value:b(),quantity:O(),currency:g(),discount_code:g(),order_id:g(),is_new_customer:j(),line_items:x({value:b(),quantity:O(),product_id:g(),product_name:g(),product_type:g(),product_vendor:g(),variant_id:g(),variant_name:g()})},e.update(n),e}return Q(n,t),n}(P);var Y=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}();const Z=function(t){function n(n){var e=t.call(this)||this;return e.action="checkout",e.fields={value:b(),quantity:O(),currency:g(),discount_code:g(),line_items:x({value:b(),quantity:O(),product_id:g(),product_name:g(),product_type:g(),product_vendor:g(),variant_id:g(),variant_name:g()})},e.update(n),e}return Y(n,t),n}(P);var tt=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}();const nt=function(t){function n(n){var e=t.call(this)||this;return e.action="lead",e.fields={type:g(),category:g(),value:b(),currency:g()},e.update(n),e}return tt(n,t),n}(P);var et=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}();const rt=function(t){function n(n){var e=t.call(this)||this;return e.action="click",e.fields={type:g(),category:g()},e.update(n),e}return et(n,t),n}(P);var ot="__spdt_opt_out";var it=new t;"function"==typeof window.fetch&&"function"==typeof Array.from&&function(t){(function(){if(D(ot))return!0;var t=window.location.search;return t.slice("?"===t.charAt(0)?1:0).split("&").map((function(t){return t.split("=").map(decodeURIComponent)})).filter((function(t){return"spdt_opt_out"===t[0]})).length>0?(I(ot,"1",3650),!0):void 0})()||(function(t){t.addListener("event",(function(n,e){H(n.data()),!0===e&&t.emit("send.events")}))}(t),function(t){t.addListener("debug.events",(function(n){t.addListener("event",n)}))}(t),function(t){t.addListener("alias",(function(n,e){if(n&&n.hasOwnProperty("email")&&"string"==typeof n.email){var r=n.email.trim().toLowerCase();if(r.indexOf("@")>0){var o=(new TextEncoder).encode(r);crypto.subtle.digest("SHA-256",o).then((function(r){var o=Array.from(new Uint8Array(r));n.email=o.map((function(t){return t.toString(16).padStart(2,"0")})).join(""),t.emit("event",new B(n),e)}))}else n.email=r,t.emit("event",new B(n),e)}else t.emit("event",new B(n),e)}))}(t),function(t){[{name:"product",listener:function(n,e){return t.emit("event",new $(n),e)}},{name:"addtocart",listener:function(n,e){return t.emit("event",new K(n),e)}},{name:"purchase",listener:function(n,e){return t.emit("event",new X(n),!1!==e)}},{name:"checkout",listener:function(n,e){return t.emit("event",new Z(n),e)}}].forEach((function(n){var e=n.name,r=n.listener;t.on(e,r)}))}(t),function(t){var n=function(n,e){t.emit("event",new nt(n),!1!==e)};t.on("lead",n)}(t),function(t){var n=function(n,e){t.emit("event",new rt(n),!1!==e)};t.on("click",n)}(t),function(t){var n={},e=function(e,r){e&&e.hasOwnProperty&&C.forEach((function(t){e.hasOwnProperty(t)&&"string"==typeof e[t]&&(n[t]=e[t])})),t.emit("event",new E(n),r)};t.on("view",e)}(t),F(t),function(t){var n=function(n){h?console.hasOwnProperty("warn")&&console.warn("pixel already configured."):(h=!0,y=Object.assign({},y,n),t.emit("configured",y),t.emit("view"))};t.on("configure",n);var e=function(n){h?console.hasOwnProperty("warn")&&console.warn("pixel already configured."):(h=!0,n&&(y=Object.keys(n).reduce((function(t,e){return y.hasOwnProperty(e)&&(t[e]=n[e]),t}),Object.assign({},y))),t.emit("configured",y))};t.on("conf",e)}(t),setTimeout((function(){!function(t,n){void 0===n&&(n=5e3),z(t);var e=setInterval((function(){z(t)}),n);setTimeout((function(){clearInterval(e)}),6e6),t.addListener("send.events",(function(){z(t)}))}(t)}),1))}(it);var ct=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(t.length>0)return it.emit(t[0],t[1],t[2]),new Promise((function(t){it.once("api.captured",(function(){t()}))}))};window.spdt&&window.spdt.q&&window.spdt.q.length&&window.spdt.q.forEach((function(t){ct.apply(void 0,t)})),window.pdst&&window.pdst.q&&window.pdst.q.length&&window.pdst.q.forEach((function(t){ct.apply(void 0,t)})),window.spdt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return ct.apply(void 0,t)},l()===p.VersionA&&(window.pdst=window.spdt),window.hasOwnProperty("onSPDTReady")&&window.onSPDTReady&&window.onSPDTReady(),window.hasOwnProperty("onPDSTReady")&&window.onPDSTReady&&window.onPDSTReady()})()})();